\begin{tikzpicture}[
  hid/.style 2 args={
    rectangle split,
    draw=#2,
    rectangle split parts=#1,
    fill=#2!20,
    outer sep=1mm},
  mlp/.style 2 args={
    rectangle split,
    rectangle split horizontal,
    draw=#2,
    rectangle split parts=#1,
    fill=#2!20,
    outer sep=1mm}
]

 \foreach \i [count=\step from 1] in {$s_1$, $s_2$, $s_3$}
 \node (i\step) at (1.1*\step, -1.5) {\i};
  % draw embedding and hidden layers for text input
  \foreach \step in {1,...,3} {
    \node[hid={3}{green}] (e\step) at (1.1*\step, -.5) {};    
  }

        \node[mlp={4}{orange}] (h_0) at (1.1 *-.5, 2.5) {};    
  \foreach \step in {1,...,3} {
    \node[hid={2}{yellow}] (h_f_\step) at (1.1 *\step, 1.25) {};    
    \node (lblh_f_\step) at (1.1 *\step, 1.25) {\small $h_\step$};    
    \draw[->] (h_f_\step.north) -> (h_0.south);
    \draw[->] (e\step.north) -> (h_f_\step.south);
    \node[mlp={2}{yellow}] (h_\step) at (1.1 *\step, 2.5) {};    
    \node[circle, draw=blue, fill=blue!20] (y_\step) at (1.1 *\step, 3.75) {\tiny $y_\step$};    
    \draw[->] (h_\step.north) -> (y_\step.south);
    \draw[->] (h_f_\step.north) -> (h_\step.south);
    %\draw[->] (h_r_\step.north) -> (h_\step.south);
  }

  \foreach \step/\steppp in {1/2, 2/3} {
    \draw[<->] (h_f_\step.east) -> (h_f_\steppp.west);
    %\draw[->] (h_r_\steppp.west) -> (h_r_\step.east);
  }
 
    \draw[->] (h_0.north) -> (y_1.south);
    \draw[->] (h_0.north) -> (y_2.south);
    \draw[->] (h_0.north) -> (y_3.south);
    \draw[->] (y_1.east) -> (y_2.west);
    \draw[->] (y_2.east) -> (y_3.west);
    \draw[->] (h_1.north) -> (y_2.south);
    \draw[->] (h_1.north) -> (y_3.south);
    \draw[->] (h_2.north) -> (y_3.south);
    \draw [bend left=45,->] (y_1) to (y_3);
\end{tikzpicture}
